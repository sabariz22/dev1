ex7 Kubernetes Deployment and Service for Python App from Docker Hub

app.py
from flask import Flask
app = Flask(__name__)
@app.route('/')
def home():
return '<p>hello flask</p>'
if __name__ == '__main__':
app.run(host='0.0.0.0', port=5000)

requirements.txt
flask

Dockerfile
FROM python:3.9-slim
WORKDIR /app
COPY . /app
RUN pip install -r requirements.txt
EXPOSE 5000
CMD ["python", "app.py"]


docker build -t beereddy2004/hello-flask .
docker run -p 5000:5000 beereddy2004/hello-flask
Open browser â†’ http://localhost:5000

Login and push (only once):
docker login
docker push beereddy2004/hello-flask

hello-flask.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
name: hello-flask
spec:
replicas: 1
selector:
matchLabels:
app: flask
template:
metadata:
labels:
app: flask
spec:
containers:
- name: flask
image: beereddy2004/hello-flask
ports:
- containerPort: 5000
---
apiVersion: v1
kind: Service
metadata:
name: flask-svc
spec:
type: NodePort
selector:
app: flask
ports:
- port: 5000
targetPort: 5000


Deploy on Minikube
minikube start --driver=docker

kubectl apply -f hello-flask.yaml

kubectl get all

Access the App
minikube service flask-svc --url